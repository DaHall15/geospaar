---
title: "Geospatial Analysis with R"
author: "Lyndon Estes & Zhiwen Zhu"
date: "10/11/2017"
output:
  slidy_presentation: 
    default:
    css: custom.css
    fig_height: 4
    fig_width: 6
subtitle: Class 12
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
# options(repos = c(CRAN = "http://ftp.ussg.iu.edu/CRAN/"))
```

## Today

- Housekeeping
    - Course structure
    - Zambia
- *apply/Unit 1 review
- Beginning of spatial stuff

## *apply

- Used primarily for ___split-apply-combine___
- [Supplemental vignette](../class11-supplemental.html)

Exercise: 

Create these data
```{r}
set.seed(1)
dat <- data.frame("V1" = 1:100, 
                  "V2" = sample(1:100, size = 100, replace = TRUE),
                  "grp" = letters[sample(1:5, size = 100, replace = TRUE)])
```

1. Write `for` loop that splits on unique values of "grp", and prints `mean` of "v2"
2. Do the same split-apply-combine with `lapply`

## Spatial objects

What are some of the main classes of Spatial* objects? 

What is the main class of most Spatial* objects


### Starting with points
```{r}
pts <- data.frame(x = c(37.1, 37.2, 37.21, 37.1), 
                  y = c(0, 0.1, -0.2, -0.1))

plot(pts)
```

How do you turn this into `SpatialPoints`? 

How about `SpatialLines`?

How about `SpatialPolygons`?

## Answers
```{r, error = TRUE}
library(sp)

# spatial points
coordinates(pts) <- ~x + y

# spatial lines
line1 <- as(pts, "SpatialLines")

# Another line
line2 <- as(pts[c(2, 1, 3, 4), ], "SpatialLines")

# Polygons
poly1 <- as(line1, "SpatialPolygons")  # fail
poly1 <- as(pts, "SpatialPolygons")  # fail

# Correct
p <- Polygon(pts)
ps <- Polygons(list(p), 1)
sps <- SpatialPolygons(list(ps))

plot(sps, col = "grey")
lines(line1, col = "red")
lines(line2, col = "blue")
points(pts)
```


## Converting to Spatial*DataFrames

```{r}
lab <- data.frame("lab" = letters[1:4])
SpatialPointsDataFrame(pts, lab)

```








